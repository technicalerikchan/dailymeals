<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #0f0f23;
            color: white;
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #1a1a2e;
            border-radius: 12px;
        }

        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }

        button:hover {
            transform: translateY(-2px);
        }

        .preview {
            margin-top: 15px;
            max-width: 100%;
        }

        .preview img {
            max-width: 100%;
            border-radius: 8px;
        }

        .info {
            margin-top: 10px;
            padding: 10px;
            background: rgba(74, 222, 128, 0.2);
            border-radius: 4px;
            color: #4ade80;
        }
    </style>
</head>

<body>
    <h1>ğŸ“¸ Upload Test</h1>

    <div class="test-section">
        <h2>Test 1: ç›´æ¥ File Input</h2>
        <input type="file" id="direct-input" accept="image/*">
        <div class="preview" id="preview-1"></div>
    </div>

    <div class="test-section">
        <h2>Test 2: æŒ‰éˆ•è§¸ç™¼ï¼ˆDailyMeals æ–¹å¼ï¼‰</h2>
        <button class="upload-trigger" data-target="test-input-2">ä¸Šå‚³ç…§ç‰‡</button>
        <input type="file" id="test-input-2" accept="image/*" hidden data-input="test">
        <div class="preview" id="preview-2"></div>
    </div>

    <div class="test-section">
        <h2>Console Log</h2>
        <div id="log" style="font-family: monospace; font-size: 0.9rem; line-height: 1.5;"></div>
    </div>

    <script>
        // æ—¥èªŒå‡½æ•¸
        function log(message) {
            console.log(message);
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += `<div>[${new Date().toLocaleTimeString()}] ${message}</div>`;
        }

        log('âœ… é é¢è¼‰å…¥å®Œæˆ');

        // Test 1: ç›´æ¥ file input
        document.getElementById('direct-input').addEventListener('change', function (e) {
            log('âœ… Test 1: æª”æ¡ˆé¸æ“‡äº‹ä»¶è§¸ç™¼');
            const file = e.target.files[0];
            if (file) {
                log(`ğŸ“ æª”æ¡ˆåç¨±: ${file.name}`);
                log(`ğŸ“Š æª”æ¡ˆå¤§å°: ${(file.size / 1024).toFixed(2)} KB`);

                const reader = new FileReader();
                reader.onload = function (e) {
                    const preview = document.getElementById('preview-1');
                    preview.innerHTML = `
            <img src="${e.target.result}" alt="Preview">
            <div class="info">âœ… åœ–ç‰‡è¼‰å…¥æˆåŠŸï¼</div>
          `;
                    log('âœ… Test 1: åœ–ç‰‡é¡¯ç¤ºæˆåŠŸ');
                };
                reader.readAsDataURL(file);
            }
        });

        // Test 2: æŒ‰éˆ•è§¸ç™¼æ–¹å¼ï¼ˆæ¨¡æ“¬ DailyMealsï¼‰
        document.querySelector('.upload-trigger').addEventListener('click', function () {
            log('âœ… æŒ‰éˆ•é»æ“Š');
            const targetId = this.getAttribute('data-target');
            document.getElementById(targetId).click();
            log(`âœ… è§¸ç™¼ file input: ${targetId}`);
        });

        document.getElementById('test-input-2').addEventListener('change', function (e) {
            log('âœ… Test 2: æª”æ¡ˆé¸æ“‡äº‹ä»¶è§¸ç™¼');
            const file = e.target.files[0];
            if (file) {
                log(`ğŸ“ æª”æ¡ˆåç¨±: ${file.name}`);

                const reader = new FileReader();
                reader.onload = function (e) {
                    const preview = document.getElementById('preview-2');
                    preview.innerHTML = `
            <img src="${e.target.result}" alt="Preview">
            <div class="info">âœ… åœ–ç‰‡è¼‰å…¥æˆåŠŸï¼é€™å°±æ˜¯ DailyMeals ä½¿ç”¨çš„æ–¹å¼</div>
          `;
                    log('âœ… Test 2: åœ–ç‰‡é¡¯ç¤ºæˆåŠŸ');
                    log('ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼ä¸Šå‚³åŠŸèƒ½æ­£å¸¸');
                };
                reader.readAsDataURL(file);
            }
        });

        log('âœ… äº‹ä»¶ç›£è½å™¨è¨­ç½®å®Œæˆ');
    </script>
</body>

</html>